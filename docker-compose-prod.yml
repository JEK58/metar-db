version: "3.8"

services:
  server:
    image: node:17.8.0-alpine3.15

    restart: always
    container_name: qnh-scraper
    environment:
      - NODE_ENV=production
      - DB_CONNECTION=${DB_CONNECTION}
      - MONGO_DB_NAME=${MONGO_DB_NAME}


    working_dir: /qnh-scraper/
    volumes:
      - ./:/qnh-scraper:rw

    command: sh -c "yarn install && yarn start"

    # ports:
    #   - 3031:3031

    # labels:
    #   traefik.enable: true
    #   traefik.http.routers.qnh-scraper.rule: "Host(qnh.lurb.org)"
    #   traefik.http.routers.qnh-scraper.entrypoints: websecure
    #   traefik.http.routers.qnh-scraper.tls.certresolver: myresolver
    #   traefik.http.routers.qnh-scraper.priority: 200
    #   traefik.http.services.qnh-scraper.loadbalancer.server.port: 3031

  